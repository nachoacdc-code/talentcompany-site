---
export type Plan = {
	name: string;
	description?: string;
	credits: string;
	bestFor?: string;
	includes: string[];
	cta: { label: string; href: string };
	highlight?: boolean;
};

export type Props = {
	heading?: string;
	subheading?: string;
	plans?: Plan[];
};

const {
	heading = 'Subscription plans',
	subheading = 'Predictable monthly design capacity measured in credits.',
	plans,
} = Astro.props;

const samplePlans: Plan[] = [
	{
		name: 'Starter',
		description: 'Light ongoing design needs.',
		credits: '~40 credits / month',
		bestFor: 'Small teams and quick turnarounds',
		includes: ['Single designer lane', 'Async collaboration', 'Simple queue & delivery'],
		cta: { label: 'Start Starter', href: '/#contact' },
	},
	{
		name: 'Growth',
		description: 'Consistent design output.',
		credits: '~100–120 credits / month',
		bestFor: 'Marketing and product teams shipping weekly',
		includes: ['PM-led workflow', 'Prioritized queue', 'Weekly planning cadence'],
		cta: { label: 'Choose Growth', href: '/#contact' },
		highlight: true,
	},
	{
		name: 'Agency',
		description: 'Continuous design support.',
		credits: '~160–200 credits / month',
		bestFor: 'High-volume requests across multiple surfaces',
		includes: ['Multi-stream capacity', 'Reporting & rollups', 'Flexible scope week to week'],
		cta: { label: 'Talk to us', href: '/#contact' },
	},
];

const resolvedPlans: Plan[] = plans?.length ? plans : samplePlans;
---

<section class="mx-auto max-w-6xl px-6 py-14 sm:py-18">
	<div class="flex flex-col gap-2">
		<h2 class="text-2xl font-semibold tracking-tight text-white sm:text-3xl">{heading}</h2>
		<p class="max-w-prose text-sm leading-relaxed text-slate-300 sm:text-base">{subheading}</p>
	</div>

	{/* Mobile / small screens: stacked cards */}
	<div class="mt-10 grid gap-4 lg:hidden">
		{resolvedPlans.map((plan) => (
			<article
				class:list={[
					'rounded-2xl border bg-slate-900/40 p-6',
					plan.highlight ? 'border-sky-400/60 shadow-sm' : 'border-slate-800',
				]}
			>
				<header class="flex items-start justify-between gap-4">
					<div>
						<h3 class="text-base font-semibold text-slate-100">{plan.name}</h3>
						{plan.description ? <p class="mt-2 text-sm text-slate-300">{plan.description}</p> : null}
					</div>
					<p class="text-right text-sm font-semibold text-slate-100">{plan.credits}</p>
				</header>

				{plan.bestFor ? (
					<p class="mt-4 text-sm text-slate-300">
						<span class="font-semibold text-slate-100">Best for:</span> {plan.bestFor}
					</p>
				) : null}

				<ul class="mt-5 space-y-2 text-sm text-slate-300">
					{plan.includes.map((f) => (
						<li class="flex gap-2">
							<span class="mt-0.5 inline-flex h-5 w-5 items-center justify-center rounded-full bg-sky-500/15 text-sky-300">
								✓
							</span>
							<span>{f}</span>
						</li>
					))}
				</ul>

				<a
					class:list={[
						'mt-6 inline-flex w-full items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold transition focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950',
						plan.highlight
							? 'bg-sky-500 text-slate-950 hover:bg-sky-400 focus-visible:ring-sky-300'
							: 'border border-slate-800 bg-slate-900/60 text-slate-100 hover:bg-slate-900 focus-visible:ring-slate-400',
					]}
					href={plan.cta.href}
				>
					{plan.cta.label}
				</a>
			</article>
		))}
	</div>

	{/* Desktop: 3-column comparison table */}
	<div class="mt-10 hidden overflow-x-auto lg:block">
		<table class="w-full border-separate border-spacing-0 overflow-hidden rounded-2xl border border-slate-800 bg-slate-900/40">
			<caption class="sr-only">{heading}</caption>
			<thead>
				<tr>
					<th scope="col" class="w-56 border-b border-slate-800 px-6 py-4 text-left text-sm font-semibold text-slate-100">
						Plan
					</th>
					{resolvedPlans.map((plan) => (
						<th
							scope="col"
							class:list={[
								'border-b border-slate-800 px-6 py-4 text-left text-sm font-semibold text-slate-100',
								plan.highlight ? 'bg-slate-900/60' : '',
							]}
						>
							<div class="flex items-baseline justify-between gap-3">
								<span>{plan.name}</span>
								<span class="text-xs font-semibold text-slate-300">{plan.credits}</span>
							</div>
							{plan.description ? <p class="mt-2 text-xs text-slate-300">{plan.description}</p> : null}
						</th>
					))}
				</tr>
			</thead>
			<tbody>
				<tr>
					<th scope="row" class="border-b border-slate-800 px-6 py-4 text-left text-sm font-semibold text-slate-100">
						Best for
					</th>
					{resolvedPlans.map((plan) => (
						<td class="border-b border-slate-800 px-6 py-4 text-sm text-slate-300">
							{plan.bestFor ?? '—'}
						</td>
					))}
				</tr>
				<tr>
					<th scope="row" class="border-b border-slate-800 px-6 py-4 text-left text-sm font-semibold text-slate-100">
						Includes
					</th>
					{resolvedPlans.map((plan) => (
						<td class="border-b border-slate-800 px-6 py-4">
							<ul class="space-y-2 text-sm text-slate-300">
								{plan.includes.map((item) => (
									<li class="flex gap-2">
										<span class="mt-0.5 inline-flex h-5 w-5 items-center justify-center rounded-full bg-sky-500/15 text-sky-300">
											✓
										</span>
										<span>{item}</span>
									</li>
								))}
							</ul>
						</td>
					))}
				</tr>
				<tr>
					<th scope="row" class="px-6 py-5 text-left text-sm font-semibold text-slate-100">
						CTA
					</th>
					{resolvedPlans.map((plan) => (
						<td class="px-6 py-5 align-top">
							<a
								class:list={[
									'inline-flex w-full items-center justify-center rounded-xl px-4 py-2 text-sm font-semibold transition focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-slate-950',
									plan.highlight
										? 'bg-sky-500 text-slate-950 hover:bg-sky-400 focus-visible:ring-sky-300'
										: 'border border-slate-800 bg-slate-900/60 text-slate-100 hover:bg-slate-900 focus-visible:ring-slate-400',
								]}
								href={plan.cta.href}
							>
								{plan.cta.label}
							</a>
						</td>
					))}
				</tr>
			</tbody>
		</table>
	</div>
</section>

